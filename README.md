# 微信聊天机器人

这是一个基于Python开发的微信智能机器人。机器人会根据用户的提问，从知识库中检索相关的数据并返回给用户。

## 功能特性

- **智能问答**：根据用户提问匹配相关采样点信息
- **地区权重匹配**：支持省份、城市、区县三级地区名称匹配，并根据匹配程度计算权重
- **可定制知识库**：通过JSON文件自定义问答内容
- **Excel数据转换**：支持将Excel格式的采样点数据转换为知识库

## 项目结构

```
├── WeChatBot copy.py   # 主程序文件
├── sampling_knowledge_base_example.json  # 示例知识库文件
├── .gitignore          # Git忽略文件配置
├── requirements.txt    # 项目依赖
└── README.md           # 项目说明文档
```

## 技术栈

- **Python 3.7+**
- **wxauto** - 微信自动操作库
- **pywin32** - Windows系统交互
- **JSON** - 数据存储格式

## 安装部署

### 前置要求

- Windows操作系统
- Python 3.7或更高版本
- 已登录的微信客户端

### 安装步骤

1. **克隆项目**
   ```bash
   git clone <your-github-repo-url>
   cd <project-directory>
   ```

2. **安装依赖**
   ```bash
   pip install -r requirements.txt
   ```

3. **配置知识库**
   - 确保`sampling_knowledge_base.json`文件存在且格式正确
   - 如需自定义内容，请按照JSON格式规范修改

## 使用方法

1. **启动微信客户端**
   - 确保已登录您的微信账号
   - 保持微信窗口在桌面可见

2. **运行机器人**
   ```bash
   python "WeChatBot copy.py"
   ```

3. **与机器人交互**
   - 在微信中向机器人发送消息
   - 例如："上海市有哪些采样点？"
   - 机器人会自动从知识库中检索并返回相关信息

## 自定义知识库配置

项目提供了`sampling_knowledge_base_example.json`作为示例，您需要创建自己的知识库文件：

### 步骤：
1. **复制示例文件**：将`sampling_knowledge_base_example.json`复制并重命名为`sampling_knowledge_base.json`
2. **编辑内容**：打开您的知识库文件，按照以下格式添加问答对：
   ```json
   [
     {
       "question": "您的问题文本",
       "answer": "您的回答文本，换行符请使用\\n"
     },
     {
       "question": "另一个问题文本",
       "answer": "另一个回答文本"
     }
   ]
   ```
3. **更新代码**：在`WeChatBot copy.py`中将`KNOWLEDGE_BASE_FILE`变量修改为您的知识库文件名
4. **保存并测试**：保存修改后，运行程序测试知识库功能

### 提示：
- 确保JSON格式严格正确，特别是字符串使用双引号
- 多行文本使用`\n`转义换行符
- 可以根据需要添加任意数量的问答对
- 问题中建议包含地区名称，以便地区权重匹配功能正常工作

## 示例问题（基于示例知识库）

- "示例地区1有哪些采样点？"
- "示例地区2的采样点在哪里？"
- "如何使用采样服务？"

## 注意事项

1. 程序运行时需要保持微信窗口在桌面可见
2. 确保知识库JSON文件格式正确，否则可能导致程序错误
3. 目前仅支持Windows系统
4. 仅在用户提问包含明确地区信息时才能正确匹配
5. 初始运行时使用的是示例知识库，请务必配置您自己的知识库文件
6. 请不要在示例知识库中存储任何敏感或机密信息

## 许可证

MIT License

## 贡献

欢迎提交Issue和Pull Request来改进这个项目！
